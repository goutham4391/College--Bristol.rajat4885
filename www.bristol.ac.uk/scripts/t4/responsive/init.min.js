/* author: ben.calder@bristol.ac.uk */var brisac=brisac||{};!function(){if(window.location.search.indexOf("ede=true")>-1){var a=document.createElement("script");return a.src="/scripts/t4/responsive/d-edit/d-edit.js",document.getElementsByTagName("head")[0].appendChild(a),!1}var b=document.getElementsByTagName("html")[0];brisac.g={bodyTag:document.body,MEDIASTATES:{small:10,medium:20,large:30},anchor:window.location.hash.substring(1),isOperaMini:"[object OperaMini]"===Object.prototype.toString.call(window.operamini),ie8OrBelow:b.className.indexOf("lt-ie9")>-1},brisac.u={addEvent:function(a,b,c){a&&(a.attachEvent?(a["e"+b+c]=c,a[b+c]=function(){a["e"+b+c](window.event)},a.attachEvent("on"+b,a[b+c])):a.addEventListener(b,c,!1))},cancelDefaultAction:function(a){a.preventDefault&&a.preventDefault(),a.returnValue=!1},addClass:function(a,b){var c=b.className;-1==c.indexOf(a)&&(""!==c&&(a=" "+a),b.className=c+a)},removeClass:function(a,b){var c=b.className,d=new RegExp("\\s?\\b"+a+"\\b","g");c=c.replace(d,""),b.className=c},is_all_ws:function(a){return!/[^\t\n\r ]/.test(a.textContent)},is_ignorable:function(a){return 8==a.nodeType||3==a.nodeType&&brisac.u.is_all_ws(a)},node_after:function(a){for(;a=a.nextSibling;)if(!brisac.u.is_ignorable(a))return a;return null},insertAfter:function(a,b){b.parentNode.insertBefore(a,brisac.u.node_after(b))},wrapElement:function(a,b){var c;c="string"==typeof a?document.querySelectorAll(a):a;var d=c.length;if(d>0){for(var e=document.createElement(b),f=0;d>f;f++)e.appendChild(c[f]);return e}return void 0},addLoadEvent:function(a){var b=window.onload;window.onload="function"!=typeof window.onload?a:function(){b&&b(),a()}},getCurrentMediaState:function(){var a=document.getElementById("utilityDiv"),b="";return window.getComputedStyle?b=window.getComputedStyle(a,null).getPropertyValue("width"):a.currentStyle&&(b=a.currentStyle.width),b=parseInt(b,10)},uncommentElements:function(a,b){var c=a.innerHTML;if(c.indexOf("<!-- ||")>-1&&c.indexOf("|| -->")>-1&&-1===c.indexOf("<!-- ||  -->")){if(b){var d=document.createElement("div");d.innerHTML=c;for(var e=d.childNodes,f=0;f<e.length;f++)if(8===e[f].nodeType){var g=e[f].data;g=g.replace(/src=\"/g,'data-src="'),e[f].data=g}c=d.innerHTML}c=c.replace(/<!-- \|\|/g,""),c=c.replace(/\|\| -->/g,""),a.innerHTML=c}}},brisac.m={},brisac.m.mediator=function(){var a=this;a.channels=[];var b=function(b,c){return a.channels[b]||(a.channels[b]=[]),a.channels[b].push({context:this,callback:c}),this},c=function(b){if(!a.channels[b])return!1;for(var c=Array.prototype.slice.call(arguments,1),d=0,e=a.channels[b].length;e>d;d++){var f=a.channels[b][d];f.callback.apply(f.context,c)}return this};return{publish:c,subscribe:b}}(),brisac.m.fog=function(){var a,b=(function(){a=document.createElement("div"),a.id="fog",brisac.g.bodyTag.appendChild(a)}(),function(b){brisac.u.addClass("cover",a),b&&brisac.u.addClass("hideAtDesktop",a),brisac.m.mediator.publish("fogCover")}),c=function(){brisac.u.removeClass("cover",a),brisac.u.removeClass("hideAtDesktop",a),brisac.m.mediator.publish("fogLifted")};return brisac.u.addEvent(a,"click",function(){c()}),{cover:b,lift:c}}(),brisac.m.mainNav=function(){var a=document.getElementById("navOpenBtn"),c=!1,d=function(){var a=document.querySelector(".nav-wrapper").offsetHeight;brisac.u.removeClass("showNav",b),window.scrollBy(0,-a),c=!1},e=function(){brisac.u.addEvent(a,"click",function(a){if(Modernizr.flexbox&&brisac.g.currentMediastate===brisac.g.MEDIASTATES.small||Modernizr.flexbox&&brisac.g.currentMediastate===brisac.g.MEDIASTATES.medium){var e=a||window.event;return c?(d(),brisac.m.fog.lift()):(brisac.u.addClass("showNav",b),brisac.m.fog.cover(!0),c=!0),brisac.u.cancelDefaultAction(e)}}),brisac.m.mediator.subscribe("fogLifted",function(){c&&d()});for(var e=document.querySelectorAll("ul.multilevel-linkul-0, ul.multilevel-linkul-1"),f=e.length,g=0;f>g;g++){var h=e[g].parentNode;brisac.u.addClass("currentparent",h)}brisac.u.addClass("showJSNav",b)};return{init:e}}(),brisac.m.navDrop=function(){var a=document.querySelector(".has-nav-dropdown"),b=function(){brisac.u.removeClass("active",a)},c=function(){brisac.u.addEvent(a,"click",function(c){if(brisac.g.currentMediastate>brisac.g.MEDIASTATES.medium){var d=c||window.event,e=d.target.className,f=a.className.indexOf("active")>-1;e.indexOf("icon-arrow-down")>-1&&brisac.u.cancelDefaultAction(d),f?(b(),brisac.m.fog.lift()):(brisac.u.addClass("active",a),brisac.m.fog.cover())}}),brisac.m.mediator.subscribe("fogLifted",function(){b()}),brisac.m.mediator.subscribe("mediaStateChange",function(){a.className.indexOf("active")>-1&&brisac.g.currentMediastate<brisac.g.MEDIASTATES.large&&(b(),brisac.m.fog.lift())})};return{init:c}}(),brisac.m.collapsibleBlock=function(a){this.block=a,this.height=a.offsetHeight},brisac.m.collapsibleBlock.prototype.init=function(){var a=this;a.height>200&&(this.collapsed=!0,a.button=document.createElement("a"),a.button.setAttribute("href","#"),a.button.className="collapseBtn btn btn-small btn-weak icon-plus",a.button.innerHTML="Show more",brisac.u.insertAfter(a.button,a.block),brisac.u.addClass("collapsed verticalSlide",a.block),brisac.u.addEvent(a.button,"click",function(b){var c=b||window.event;brisac.u.cancelDefaultAction(c),a.click()})),brisac.m.mediator.subscribe("windowResize",function(){a.updateHeight()})},brisac.m.collapsibleBlock.prototype.updateHeight=function(){if(this.collapsed){var a=this.block.offsetHeight;brisac.u.removeClass("collapsed",this.block),this.block.setAttribute("style",""),this.height=this.block.offsetHeight,brisac.u.addClass("collapsed",this.block),this.block.setAttribute("style","height: "+a+"px")}else this.block.setAttribute("style",""),this.height=this.block.offsetHeight,this.block.setAttribute("style","height: "+this.height+"px")},brisac.m.collapsibleBlock.prototype.click=function(){this.collapsed===!0?(this.collapsed=!1,brisac.u.removeClass("collapsed",this.block),this.block.setAttribute("style","height: "+this.height+"px"),this.button.innerHTML="Show less",brisac.u.removeClass("icon-plus",this.button),brisac.u.addClass("icon-minus",this.button)):(this.collapsed=!0,brisac.u.addClass("collapsed",this.block),this.block.setAttribute("style",""),this.button.innerHTML="Show more",brisac.u.removeClass("icon-minus",this.button),brisac.u.addClass("icon-plus",this.button))};var c=brisac.u.wrapElement(".main-col-child","section"),d=document.querySelector(".godzilla"),e=document.querySelector(".slider.full-width"),f=document.getElementById("pagetitle");if(c)if(brisac.u.addClass("main-col",c),d)brisac.u.insertAfter(c,d);else if(e)brisac.u.insertAfter(c,e);else if(f)brisac.u.insertAfter(c,f);else{var g=document.getElementsByTagName("main")[0];g.insertBefore(c,g.firstChild)}if(f||brisac.u.addClass("no-pagetitle",brisac.g.bodyTag),d){var h=document.querySelector("div.wrapper"),i=d.querySelector(".slider-mega"),j=d.querySelector(".overlay-box");if(i&&(sliderWrapper=document.createElement("div"),sliderWrapper.className="container-slider-mega bg-stone",brisac.g.bodyTag.insertBefore(sliderWrapper,h),sliderWrapper.appendChild(i)),j)brisac.g.bodyTag.insertBefore(j,h);else for(var k=d.querySelectorAll(".godzilla > div"),l=0,m=k.length;m>l;l++)brisac.g.bodyTag.insertBefore(k[l],h);d.parentNode.removeChild(d)}document.querySelector&&brisac.u.addLoadEvent(function(){var a,c=0;brisac.u.addEvent(window,"resize",function(){var b=new Date;b-c>250&&(brisac.g.currentMediastate=brisac.u.getCurrentMediaState(),brisac.m.mediator.publish("windowResize"),a!==brisac.g.currentMediastate&&(brisac.m.mediator.publish("mediaStateChange"),a=brisac.g.currentMediastate),c=b)});var d=document.createElement("div");d.id="utilityDiv",brisac.g.bodyTag.appendChild(d),brisac.g.currentMediastate=brisac.u.getCurrentMediaState();var e=function(a){var b=document.querySelectorAll("script[data-src]"),c=b.length;if(c>0){var d=[];a&&d.push("/scripts/t4/responsive/utilities.min.js");for(var e=0;c>e;e++){var f=b[e].getAttribute("data-src");d.push(f)}yepnope({load:d})}};if(brisac.g.isOperaMini)brisac.u.addClass("operamini",b);else{if(!brisac.g.ie8OrBelow&&(brisac.m.mainNav.init(),brisac.m.navDrop.init(),brisac.g.currentMediastate>brisac.g.MEDIASTATES.small))for(var f=document.querySelectorAll(".module, .hp-features-side"),g=f.length,h=0;g>h;h++)brisac.u.uncommentElements(f[h]);var i=document.querySelector(".nav-intranet");i&&brisac.u.insertAfter(i,document.querySelector(".page-feedback"));for(var j=document.querySelectorAll(".collapsible"),k=0,l=j.length;l>k;k++);}var m=document.querySelectorAll(".includeLink").length>0,n=document.querySelectorAll("div.dropdown").length>0,o=document.querySelectorAll("div.slider").length>0,p=document.querySelectorAll("table").length>0,q=[];if(m&&q.push("ajax"),n&&q.push("drop"),o&&q.push("slider"),p&&q.push("tables"),q.length>0){q=q.join("-");var r="/scripts/t4/responsive/"+q+".min.js";yepnope.injectJs(r,e)}else e(!0)})}();